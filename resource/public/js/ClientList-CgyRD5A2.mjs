var w=(c,x,p)=>new Promise((n,m)=>{var C=r=>{try{f(p.next(r))}catch(v){m(v)}},S=r=>{try{f(p.throw(r))}catch(v){m(v)}},f=r=>r.done?n(r.value):Promise.resolve(r.value).then(C,S);f((p=p.apply(c,x)).next())});import{u as se}from"./index.es-CT2W4LN0.mjs";import{g as ue,s as de,d as ce}from"./Secret.vue_vue_type_script_setup_true_name_Secret_lang-LTbEl4Zr.mjs";import{_ as pe}from"./ClientForm.vue_vue_type_script_setup_true_lang-CF1EwHmh.mjs";import{S as me,D as $,E as fe,e as ve}from"./bootstrap-5eopxyZm.mjs";import{R as _e,M as ye}from"./RollbackOutlined-C4ajMdEa.mjs";import{a6 as Ce,P as _,J as q,aI as o,aF as d,aJ as M,n as t,aH as l,aa as i,ao as y,h as F,aG as h,F as A,aY as B,aW as G,aX as ge}from"../jse/index-index-CmiOfTxA.mjs";function ke(c){return w(this,null,function*(){return ue(c)})}function Ie(c){return w(this,null,function*(){return de(c)})}function he(c){return w(this,null,function*(){return ce(c)})}const be={style:{"overflow-y":"scroll"}},xe=Ce({__name:"ClientList",setup(c){const x=[{title:"Id",dataIndex:"id",key:"id",sorter:!0,defaultSortOrder:"ascend"},{title:"Enabled",dataIndex:"enabled",key:"enabled",sorter:!0},{title:"ClientName",dataIndex:"clientName",key:"clientName",name:"client_name",sorter:!0,filtered:!0},{title:"ClientId",dataIndex:"clientId",key:"client_id",sorter:!0,filtered:!0},{title:"Scopes",dataIndex:"scopes",key:"scopes",sorter:!0,filtered:!0},{title:"GrantTypes",dataIndex:"grantTypes",key:"grantTypes",sorter:!0,filtered:!0},{title:"Actions",key:"action"}],p=_(),n=_({ClientId:"",ClientName:""}),m=_("id"),C=_("asc"),S=q(()=>{const e=[];return n.value.ClientId!==""&&e.push("client_Id like ?"),n.value.ClientName!==""&&e.push("client_Name like ?"),e}),f=q(()=>{const e=[];return n.value.ClientId!==""&&e.push(`%${n.value.ClientId}%`),n.value.ClientName!==""&&e.push(`%${n.value.ClientName}%`),e}),{data:r,run:v,refresh:L,loading:V,total:J,current:T,pageSize:z}=se(ke,{defaultParams:[{page:1,pageSize:10,sortField:"id",sortOrder:"asc",filters:S.value,args:f.value}],pagination:{currentKey:"page",pageSizeKey:"pageSize"}}),K=new Map([["clientId","client_id"],["clientName","client_name"],["grantTypes","grant_types"],["id","id"]]),H=q(()=>({total:J.value,current:T.value,pageSize:z.value})),P=()=>{setTimeout(()=>{L()},50)},W=()=>{console.log("searchModel",n.value),setTimeout(()=>{v({page:T.value,pageSize:z.value,sortField:m.value,sortOrder:C.value,filters:S.value,args:f.value})},500)},X=()=>{n.value={ClientId:"",ClientName:""},p.value.resetFields(),P()},g=_(!1),O=_({id:0,enabled:!0,clientId:"",clientName:"",grantTypes:"authorization_code",scopes:"openid",requireConsent:!0,requirePkce:!1,requireSecret:!0,allowPlainTextPkce:!1,allowOfflineAccess:!1,alwaysIncludeUserClaimsInIdToken:!1,allowRememberConsent:!0,redirectUris:"http://localhost:8080/signin-oidc"}),U=_(),Y=e=>{O.value=e,g.value=!0},j=e=>{he(e),P()},Q=()=>w(this,null,function*(){try{const e=yield U.value.validate();if(!e)return;console.log("form validate",e)}catch(e){console.log("error submit:",e);return}Ie(O.value),g.value=!1,P()}),Z=()=>{U.value.resetForm(),g.value=!1},ee=()=>{O.value={id:0,enabled:!0,clientId:"",clientName:"",grantTypes:"authorization_code",scopes:"openid",requireConsent:!0,requirePkce:!1,requireSecret:!0,allowPlainTextPkce:!1,allowOfflineAccess:!1,alwaysIncludeUserClaimsInIdToken:!1,allowRememberConsent:!0,redirectUris:"http://localhost:8080/signin-oidc"},g.value=!0},te=(e,a,k)=>{var b;T.value=e.current,z.value=e.pageSize,k.field?(m.value=(b=K.get(k.field))!=null?b:k.field,C.value=k.order):(m.value="Id",C.value="asc"),console.log("filter",a),v({page:T.value,pageSize:z.value,sortField:m.value,sortOrder:C.value,filters:a.value,args:f.value})};return(e,a)=>{const k=o("a-page-header"),b=o("a-input"),D=o("a-form-item"),N=o("a-button"),ae=o("a-form"),le=o("a-divider"),ne=o("a-popconfirm"),E=o("a-space"),oe=o("a-switch"),R=o("a-tag"),ie=o("a-table"),re=o("a-modal");return d(),M("div",be,[t(k,{"sub-title":"Client list page",title:"Clients"}),t(ae,{ref_key:"searchForm",ref:p,model:n.value,layout:"inline"},{default:l(()=>[t(D,{label:"ClientId"},{default:l(()=>[t(b,{value:n.value.ClientId,"onUpdate:value":a[0]||(a[0]=s=>n.value.ClientId=s),placeholder:"ClientId"},null,8,["value"])]),_:1}),t(D,{label:"ClientName"},{default:l(()=>[t(b,{value:n.value.ClientName,"onUpdate:value":a[1]||(a[1]=s=>n.value.ClientName=s),placeholder:"ClientName"},null,8,["value"])]),_:1}),t(D,null,{default:l(()=>[t(N,{type:"primary",onClick:W},{icon:l(()=>[t(i(me))]),default:l(()=>[a[3]||(a[3]=y(" Search "))]),_:1}),t(N,{icon:F(i(_e)),type:"primary",onClick:X},{default:l(()=>a[4]||(a[4]=[y(" Reset ")])),_:1},8,["icon"]),t(i($),{type:"vertical"}),t(N,{icon:F(i(ye)),type:"primary",onClick:ee},{default:l(()=>a[5]||(a[5]=[y(" New ")])),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),t(le,{type:"horizontal"}),t(ie,{columns:x,"data-source":i(r)?i(r).list:null,loading:i(V),pagination:H.value,run:i(v),onChange:te},{bodyCell:l(({column:s,record:I})=>[s.key==="action"?(d(),h(E,{key:0},{default:l(()=>[t(N,{icon:F(i(fe)),type:"primary",onClick:u=>Y(I)},{default:l(()=>a[6]||(a[6]=[y(" Edit ")])),_:2},1032,["icon","onClick"]),t(i($),{type:"vertical"}),t(ne,{title:"Delete Client  ",onConfirm:u=>j(I.id)},{default:l(()=>[t(N,{icon:F(i(ve)),danger:""},{default:l(()=>a[7]||(a[7]=[y("Delete")])),_:1},8,["icon"])]),_:2},1032,["onConfirm"])]),_:2},1024)):s.key==="enabled"?(d(),h(oe,{key:1,checked:I.enabled,"onUpdate:checked":u=>I.enabled=u,enabled:"false",size:"small"},null,8,["checked","onUpdate:checked"])):s.key==="scopes"?(d(),h(E,{key:2,size:"small",wrap:""},{default:l(()=>[(d(!0),M(A,null,B(I.scopes.split(" "),u=>(d(),h(R,{key:u,color:"blue"},{default:l(()=>[y(G(u),1)]),_:2},1024))),128))]),_:2},1024)):s.key==="grantTypes"?(d(),h(E,{key:3,size:"small",wrap:""},{default:l(()=>[(d(!0),M(A,null,B(I.grantTypes.split(" "),u=>(d(),h(R,{key:u,color:"geekblue"},{default:l(()=>[y(G(u==="urn:ietf:params:oauth:grant-type:device_code"?"device code":u),1)]),_:2},1024))),128))]),_:2},1024)):ge("",!0)]),_:1},8,["data-source","loading","pagination","run"]),t(re,{open:g.value,"onUpdate:open":a[2]||(a[2]=s=>g.value=s),title:"Edit Client Info",onCancel:Z,onOk:Q},{default:l(()=>[t(pe,{ref_key:"clientForm",ref:U,client:O.value},null,8,["client"])]),_:1},8,["open"])])}}});export{xe as default};
