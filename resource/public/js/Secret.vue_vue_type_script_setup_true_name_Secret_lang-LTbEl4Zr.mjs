var u=(e,c,p)=>new Promise((D,v)=>{var E=s=>{try{f(p.next(s))}catch(l){v(l)}},k=s=>{try{f(p.throw(s))}catch(l){v(l)}},f=s=>s.done?D(s.value):Promise.resolve(s.value).then(E,k);f((p=p.apply(e,c)).next())});import{a as L}from"./index.es-CT2W4LN0.mjs";import{r as m,i as M,g as O,e as j}from"./bootstrap-5eopxyZm.mjs";import{b2 as z,a6 as H,J as W,P as S,S as X,aI as o,aF as x,aJ as P,n as a,aH as n,ao as d,aW as w,aX as T,aa as G,aG as A,F as K}from"../jse/index-index-CmiOfTxA.mjs";const _={Page:"/api/v1/oauth2/client/list",Get:"/api/v1/oauth2/client/",PUT:"/api/v1/oauth2/client",Delete:"/api/v1/oauth2/client/",GETSECRET:"/api/v1/oauth2/client/getsecret",DeleteSecret:"/api/v1/oauth2/client/deletesecret",GenerateSecret:"/api/v1/oauth2/client/generatesecret"};function ue(e){return u(this,null,function*(){return m.post(_.Page,e)})}function ce(e){return u(this,null,function*(){return m.delete(_.Delete+e)})}function pe(e){return u(this,null,function*(){return m.put(_.PUT,e)})}function Q(e){return u(this,null,function*(){return m.get(_.GETSECRET,{params:{clientid:e}})})}function Z(e){return u(this,null,function*(){return m.delete(_.DeleteSecret,{params:{id:e}})})}function ee(e){return u(this,null,function*(){return m.post(_.GenerateSecret,e)})}const{locale:te}=M.global;function ae(e){return z(e,"YYYY-MM-DD dddd",{locales:te.value})}const ne={key:0},de=H({__name:"Secret",props:{clientId:{}},setup(e){const c=e,{data:p,run:D,refresh:v,loading:E}=L(Q,{defaultParams:[c.clientId]}),k=W(()=>{var i;return(i=p.value)==null?void 0:i.Secrets}),f=i=>u(this,null,function*(){yield Z(i),v()}),s=S(O().add(1,"year")),l=S({client_id:c.clientId,expiration:s.value}),g=S(""),y=S(""),C=S(!1),U=()=>u(this,null,function*(){try{console.log(l);const i=yield ee(l.value);y.value=i.Secret,l.value.name="",console.log(`new secret:${y.value}`),v(),C.value=!1}catch(i){g.value=i.msg}});return X(()=>c.clientId,()=>{D(c.clientId),y.value="",g.value=""}),(i,t)=>{const b=o("a-button"),h=o("a-tag"),q=o("a-list-item-meta"),F=o("a-popconfirm"),N=o("a-list-item"),R=o("a-list"),Y=o("a-input"),I=o("a-form-item"),B=o("a-date-picker"),V=o("a-form"),$=o("a-alert"),J=o("a-modal");return x(),P(K,null,[a(b,{type:"link",onClick:t[0]||(t[0]=r=>{C.value=!0,g.value=""})},{default:n(()=>t[4]||(t[4]=[d(" Generate Secrete ")])),_:1}),y.value!==""?(x(),P("div",ne,[t[5]||(t[5]=d(" new secret : ")),a(h,{color:"warning"},{default:n(()=>[d(w(y.value),1)]),_:1}),t[6]||(t[6]=d(" only show once, copy it before you close this dialog "))])):T("",!0),a(R,{"data-source":k.value,loading:G(E),"item-layout":"horizontal"},{renderItem:n(({item:r})=>[a(N,null,{actions:n(()=>[a(F,{title:"Delete Secret  ",onConfirm:oe=>f(r.id)},{default:n(()=>[a(b,{type:"link"},{default:n(()=>[a(G(j))]),_:1})]),_:2},1032,["onConfirm"])]),default:n(()=>[a(q,null,{description:n(()=>[d(" Expired at: "+w(G(ae)(r.Expiration)),1)]),title:n(()=>[d(w(r.id)+" "+w(r.name),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data-source","loading"]),a(J,{open:C.value,"onUpdate:open":t[3]||(t[3]=r=>C.value=r),title:"Generating Secret",width:"30%",onOk:U},{default:n(()=>[a(V,null,{default:n(()=>[a(I,{label:"Name"},{default:n(()=>[a(Y,{value:l.value.name,"onUpdate:value":t[1]||(t[1]=r=>l.value.name=r),"aria-required":"true"},null,8,["value"])]),_:1}),a(I,{label:"Expiration"},{default:n(()=>[a(B,{value:l.value.expiration,"onUpdate:value":t[2]||(t[2]=r=>l.value.expiration=r)},null,8,["value"])]),_:1})]),_:1}),g.value?(x(),A($,{key:0,message:g.value,type:"error"},null,8,["message"])):T("",!0)]),_:1},8,["open"])],64)}}});export{de as _,ce as d,ue as g,pe as s};
