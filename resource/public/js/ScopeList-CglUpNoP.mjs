var y=(i,F,p)=>new Promise((z,u)=>{var m=s=>{try{k(p.next(s))}catch(v){u(v)}},o=s=>{try{k(p.throw(s))}catch(v){u(v)}},k=s=>s.done?z(s.value):Promise.resolve(s.value).then(m,o);k((p=p.apply(i,F)).next())});import{u as ne}from"./index.es-CT2W4LN0.mjs";import{r as w,h as le,S as ie,D as R,E as re,e as se,M as ce}from"./bootstrap-5eopxyZm.mjs";import{S as ue}from"./enum-BLvisX2J.mjs";import{_ as de}from"./ScopeForm.vue_vue_type_script_setup_true_lang-TgJuBjpp.mjs";import{R as pe,M as me}from"./RollbackOutlined-C4ajMdEa.mjs";import{a6 as ve,P as d,J as M,aI as r,aF as $,aJ as fe,n as t,aa as l,aH as n,ao as S,h as x,aG as B,aX as _e}from"../jse/index-index-CmiOfTxA.mjs";const A={Page:"/api/v1/oauth2/scope/list",Get:"/api/v1/oauth2/scope/",PUT:"/api/v1/oauth2/scope",Delete:"/api/v1/oauth2/scope/"};function ge(i){return y(this,null,function*(){return w.post(A.Page,i)})}function ye(i){return y(this,null,function*(){return w.delete(A.Delete+i)})}function ke(i){return y(this,null,function*(){return w.put(A.PUT,i)})}function he(i){return y(this,null,function*(){return ke(i)})}const Se={class:"p-5"},ze=ve({__name:"ScopeList",setup(i){const[F,p]=le.useMessage(),z=[{title:"Id",dataIndex:"id",key:"Id",sorter:!0,defaultSortOrder:"ascend"},{title:"Enabled",dataIndex:"enabled",key:"Enabled",sorter:!0},{title:"Name",dataIndex:"name",key:"Name",name:"Name",sorter:!0,filtered:!0},{title:"Description",dataIndex:"description",key:"Description",filtered:!0},{title:"Actions",key:"action"}],u=d("id"),m=d("asc"),o=d({Name:"",Description:""}),k=M(()=>{const e=[];return o.value.Name!==""&&e.push("name like ?"),o.value.Description!==""&&e.push("description like ?"),e}),s=M(()=>{const e=[];return o.value.Name!==""&&e.push(`%${o.value.Name}%`),o.value.Description!==""&&e.push(`%${o.value.Description}%`),e}),{data:v,run:E,loading:L,total:V,current:b,pageSize:C}=ne(ge,{defaultParams:[{page:1,pageSize:10,sortField:"id",sortOrder:ue.Asc,filters:[],args:[]}],pagination:{currentKey:"page",pageSizeKey:"pageSize"}}),G=M(()=>({total:V.value,current:b.value,pageSize:C.value})),T=d(),D=()=>{setTimeout(()=>{E({page:b.value,pageSize:C.value,sortField:u.value,sortOrder:m.value,filters:k,args:s})},500)},H=()=>{console.log("searchModel",o.value),D()},J=()=>{o.value={Name:"",Description:""},T.value.resetFields(),D()},f=d(!1),N=d(),P=d(),K=e=>{N.value=e,f.value=!0},q=e=>{ce.confirm({title:`Deleting Scope ${e}`,content:`Are you sure delete this Scope ${e}?`,onOk(){ye(e).then(()=>{D()}).catch(a=>{F.warning(a),console.log(a)})},onCancel(){console.log("Cancel")}}),console.log("record",e)},X=()=>y(this,null,function*(){try{const e=yield P.value.validate();if(!e)return;console.log("form validate",e)}catch(e){console.log("error submit:",e);return}he(N.value),f.value=!1,D()}),j=()=>{P.value.resetForm(),f.value=!1},Q=()=>{N.value={id:0,enabled:!0,name:"",description:""},f.value=!0},W=(e,a,_)=>{if(b.value=e.current,C.value=e.pageSize,_.field){const g=_.field;u.value=g!=null?g:_.field,m.value=_.order}else u.value="Id",m.value="asc";console.log("filter",a),E({page:b.value,pageSize:C.value,sortField:u.value,sortOrder:m.value,filters:a.value})};return(e,a)=>{const _=r("a-page-header"),g=r("a-input"),I=r("a-form-item"),h=r("a-button"),Y=r("a-form"),Z=r("a-divider"),ee=r("a-space"),ae=r("a-checkbox"),te=r("a-table"),oe=r("a-modal");return $(),fe("div",Se,[t(l(p)),t(_,{style:{border:"1px solid rgb(235 237 240)"},"sub-title":"Scopes list page",title:"Scopes"}),t(Y,{ref_key:"searchForm",ref:T,model:o.value,layout:"inline"},{default:n(()=>[t(I,{label:"Name"},{default:n(()=>[t(g,{value:o.value.Name,"onUpdate:value":a[0]||(a[0]=c=>o.value.Name=c),placeholder:"Name"},null,8,["value"])]),_:1}),t(I,{label:"Description"},{default:n(()=>[t(g,{value:o.value.Description,"onUpdate:value":a[1]||(a[1]=c=>o.value.Description=c),placeholder:"Description"},null,8,["value"])]),_:1}),t(I,null,{default:n(()=>[t(h,{type:"primary",onClick:H},{icon:n(()=>[t(l(ie))]),default:n(()=>[a[3]||(a[3]=S(" Search "))]),_:1}),t(h,{icon:x(l(pe)),type:"primary",onClick:J},{default:n(()=>a[4]||(a[4]=[S(" Reset ")])),_:1},8,["icon"]),t(l(R),{type:"vertical"}),t(h,{icon:x(l(me)),type:"primary",onClick:Q},{default:n(()=>a[5]||(a[5]=[S(" New ")])),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),t(Z,{type:"horizontal"}),t(te,{columns:z,"data-source":l(v)?l(v).list:null,loading:l(L),pagination:G.value,run:l(E),onChange:W},{bodyCell:n(({column:c,record:O})=>[c.key==="action"?($(),B(ee,{key:0},{default:n(()=>[t(h,{icon:x(l(re)),type:"primary",onClick:U=>K(O)},{default:n(()=>a[6]||(a[6]=[S(" Edit ")])),_:2},1032,["icon","onClick"]),t(l(R),{type:"vertical"}),t(h,{icon:x(l(se)),danger:"",onClick:U=>q(O.id)},{default:n(()=>a[7]||(a[7]=[S(" Delete ")])),_:2},1032,["icon","onClick"])]),_:2},1024)):c.key==="Enabled"?($(),B(ae,{key:1,checked:O.enabled,"onUpdate:checked":U=>O.enabled=U},null,8,["checked","onUpdate:checked"])):_e("",!0)]),_:1},8,["data-source","loading","pagination","run"]),t(oe,{open:f.value,"onUpdate:open":a[2]||(a[2]=c=>f.value=c),title:"Edit Client Info",onCancel:j,onOk:X},{default:n(()=>[t(de,{ref_key:"modalForm",ref:P,"form-model":N.value},null,8,["form-model"])]),_:1},8,["open"])])}}});export{ze as default};
